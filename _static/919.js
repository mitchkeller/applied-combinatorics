"use strict";(self.webpackChunkWebComponents=self.webpackChunkWebComponents||[]).push([[919],{9919:(t,e,i)=>{i.r(e),i.d(e,{default:()=>n});var s=i(78673);class r extends s.A{constructor(t){super(t);var e=(t=t||{}).orig;this.origElem=e,this.useRunestoneServices=t.useRunestoneServices,this.multipleanswers=!1,this.divid=e.id,!0===$(this.origElem).data("multipleanswers")&&(this.multipleanswers=!0),this.children=this.origElem.childNodes,this.random=!1,$(this.origElem).is("[data-random]")&&(this.random=!0),this.correct=null,this.didSubmit=!1,this.answerList=[],this.correctList=[],this.correctIndexList=[],this.feedbackList=[],this.question=null,this.caption="Multiple Choice",this.findAnswers(),this.findQuestion(),this.findFeedbacks(),this.createCorrectList(),this.createMCForm(),this.addCaption("runestone"),this.checkServer("mChoice",!0),this.queueMathJax(this.containerDiv),"undefined"!=typeof Prism&&Prism.highlightAllUnder(this.containerDiv)}findQuestion(){const t=this.origElem.parentElement.querySelector(".exercise-statement");if(t)this.question=t;else{for(var e,i=0;i<this.origElem.childNodes.length;i++)if("LI"===this.origElem.childNodes[i].nodeName){e=this.origElem.childNodes[i].outerHTML;break}var s=$(this.origElem).html().split(e);this.question=s[0]}}findAnswers(){for(var t=[],e=0;e<this.children.length;e++)$(this.children[e]).is("[data-component=answer]")&&t.push(this.children[e]);for(var i=0;i<t.length;i++){var s=$(t[i]).attr("id"),r=!1;$(t[i]).is("[data-correct]")&&(r=!0);var n={id:s,correct:r,content:$(t[i]).html()};this.answerList.push(n)}}findFeedbacks(){for(var t=0;t<this.children.length;t++)$(this.children[t]).is("[data-component=feedback]")&&this.feedbackList.push(this.children[t].innerHTML)}createCorrectList(){for(var t=0;t<this.answerList.length;t++)this.answerList[t].correct&&(this.correctList.push(this.answerList[t].id),this.correctIndexList.push(t))}createMCForm(){this.renderMCContainer(),this.renderMCForm(),this.renderMCfeedbackDiv(),$(this.origElem).replaceWith(this.containerDiv)}renderMCContainer(){this.containerDiv=document.createElement("div"),this.questionDiv=document.createElement("div"),$(this.questionDiv).html(this.question),this.questionDiv.id=this.divid+"_prompt",this.containerDiv.appendChild(this.questionDiv),$(this.containerDiv).addClass(this.origElem.getAttribute("class")),this.containerDiv.id=this.divid}renderMCForm(){this.optsForm=document.createElement("form"),this.optsForm.id=this.divid+"_form",$(this.optsForm).attr({method:"get",action:"",onsubmit:"return false;"}),this.optsFieldSet=document.createElement("fieldset"),this.optsFieldSet.setAttribute("role","radiogroup"),this.optsFieldSet.setAttribute("aria-labelledby",this.divid+"_prompt"),this.optsForm.appendChild(this.optsFieldSet),this.renderMCFormOpts(),this.renderMCFormButtons();let t=document.createElement("legend");this.multipleanswers?t.textContent="Choose all that apply":t.textContent="Choose one",this.optsFieldSet.appendChild(t),this.containerDiv.appendChild(this.optsForm)}renderMCFormOpts(){this.optionArray=[];var t="radio";this.multipleanswers&&(t="checkbox"),this.indexArray=[];for(var e=0;e<this.answerList.length;e++)this.indexArray.push(e);this.random&&this.randomizeAnswers();let i=this,s=function(){i.isAnswered=!0};for(var r=0;r<this.answerList.length;r++){var n=this.indexArray[r],o=this.divid+"_opt_"+n,a=document.createElement("label"),h=this.answerList[n].content,c="";h.startsWith("<p>")&&(c="<p>",h=h.slice(3)),$(a).html(`${c}<input type="${t}" name="group1" value=${n} id=${o}>${String.fromCharCode("A".charCodeAt(0)+r)}. ${h}`);var d={input:$(a).find("input")[0],label:a};d.input.onclick=s,this.optionArray.push(d),this.optsFieldSet.appendChild(a),this.optsFieldSet.appendChild(document.createElement("br"))}}renderMCFormButtons(){this.submitButton=document.createElement("button"),this.submitButton.textContent="Check Me",$(this.submitButton).attr({class:"btn btn-success",name:"do answer",type:"button"}),this.multipleanswers?this.submitButton.addEventListener("click",function(){this.processMCMASubmission(!0)}.bind(this),!1):this.submitButton.addEventListener("click",function(t){t.preventDefault(),this.processMCMFSubmission(!0)}.bind(this),!1),this.optsForm.appendChild(this.submitButton),this.useRunestoneServices&&!eBookConfig.peer&&(this.compareButton=document.createElement("button"),$(this.compareButton).attr({class:"btn btn-default",id:this.divid+"_bcomp",disabled:"",name:"compare"}),this.compareButton.textContent="Compare me",this.compareButton.addEventListener("click",function(){this.compareAnswers(this.divid)}.bind(this),!1),this.optsForm.appendChild(this.compareButton))}renderMCfeedbackDiv(){this.feedBackDiv=document.createElement("div"),this.feedBackDiv.id=this.divid+"_feedback",this.feedBackDiv.setAttribute("aria-live","polite"),this.feedBackDiv.setAttribute("role","status"),this.containerDiv.appendChild(document.createElement("br")),this.containerDiv.appendChild(this.feedBackDiv)}randomizeAnswers(){for(var t,e,i=this.indexArray.length;0!==i;){e=Math.floor(Math.random()*i),i-=1,t=this.indexArray[i],this.indexArray[i]=this.indexArray[e],this.indexArray[e]=t;var s=this.feedbackList[i];this.feedbackList[i]=this.feedbackList[e],this.feedbackList[e]=s}}restoreAnswers(t){t.answer||(t.answer="");for(var e=t.answer.split(","),i=0;i<e.length;i++)for(var s=e[i],r=0;r<this.optionArray.length;r++)this.optionArray[r].input.value==s&&$(this.optionArray[r].input).attr("checked","true");this.multipleanswers?this.processMCMASubmission(!1):this.processMCMFSubmission(!1)}checkLocalStorage(){var t;if(!this.graderactive&&localStorage.length>0){var e=localStorage.getItem(this.localStorageKey());if(null!==e){try{t=JSON.parse(e).answer.split(",")}catch(t){return console.log(t.message),void localStorage.removeItem(this.localStorageKey())}for(var i=0;i<t.length;i++)for(var s=t[i],r=0;r<this.optionArray.length;r++)this.optionArray[r].input.value==s&&$(this.optionArray[r].input).attr("checked","true");this.useRunestoneServices&&(this.enableMCComparison(),this.getSubmittedOpts(),this.multipleanswers?this.logMCMAsubmission():this.logMCMFsubmission())}}}setLocalStorage(t){var e=new Date,i={answer:t.answer,timestamp:e,correct:t.correct};localStorage.setItem(this.localStorageKey(),JSON.stringify(i))}processMCMASubmission(t){this.getSubmittedOpts(),this.scoreMCMASubmission(),this.setLocalStorage({correct:this.correct?"T":"F",answer:this.givenArray.join(",")}),t&&this.logMCMAsubmission(),!eBookConfig.peer||eBookConfig.isInstructor?(this.renderMCMAFeedBack(),this.useRunestoneServices&&this.enableMCComparison()):eBookConfig.peer&&"async"===eBookConfig.peerMode&&"undefined"!=typeof studentVoteCount&&studentVoteCount>1?this.renderMCMAFeedBack():($(this.feedBackDiv).html("<p>Your Answer has been recorded</p>"),$(this.feedBackDiv).attr("class","alert alert-info")),this.didSubmit=!0}getSubmittedOpts(){var t;this.singlefeedback="",this.feedbackString="",this.givenArray=[],this.givenlog="";for(var e=this.optsForm.elements.group1,i=0;i<e.length;i++)e[i].checked&&(t=e[i].value,this.givenArray.push(t),this.feedbackString+=`<li value="${i+1}">${this.feedbackList[i]}</li>`,this.givenlog+=t+",",this.singlefeedback=this.feedbackList[i]);this.givenArray.sort()}checkCurrentAnswer(){this.getSubmittedOpts(),0!==this.givenArray.length&&(this.multipleanswers?this.scoreMCMASubmission():this.scoreMCMFSubmission())}async logCurrentAnswer(t){this.multipleanswers?await this.logMCMAsubmission(t):await this.logMCMFsubmission(t)}renderFeedback(){this.multipleanswers?this.renderMCMAFeedBack():this.renderMCMFFeedback(),this.queueMathJax(this.feedBackDiv)}scoreMCMASubmission(){this.correctCount=0;for(var t=0,e=0;t<this.correctIndexList.length&&e<this.givenArray.length;)this.givenArray[e]<this.correctIndexList[t]?e++:this.givenArray[e]==this.correctIndexList[t]?(this.correctCount++,e++,t++):t++;var i=this.givenArray.length,s=this.correctCount,r=this.correctList.length;this.answer=this.givenArray.join(","),this.correct=s===r&&r===i,this.percent=i===r?s/r:s/Math.max(i,r)}async logMCMAsubmission(t){var e=this.answer||"",i=this.correct||!1;let s={event:"mChoice",act:"answer:"+e+":"+(1==i?"correct":"no"),answer:e,correct:i,div_id:this.divid};eBookConfig.peer&&"undefined"!=typeof studentVoteCount&&(s.act=s.act+`:vote${studentVoteCount}`),void 0!==t&&(s.sid=t),await this.logBookEvent(s)}renderMCMAFeedBack(){var t="answers",e=this.givenArray.length;1===e&&(t="answer");var i=this.correctCount,s=this.correctList.length,r=this.feedbackString;this.correct?($(this.feedBackDiv).html(`✔️ <ol type="A">${r}</ul>`),$(this.feedBackDiv).attr("class","alert alert-info")):($(this.feedBackDiv).html(`✖️ You gave ${e} ${t} and got ${i} correct of ${s} needed.<ol type="A">${r}</ul>`),$(this.feedBackDiv).attr("class","alert alert-danger"))}processMCMFSubmission(t){this.getSubmittedOpts(),this.scoreMCMFSubmission(),this.setLocalStorage({correct:this.correct?"T":"F",answer:this.givenArray.join(",")}),t&&this.logMCMFsubmission(),!eBookConfig.peer||eBookConfig.isInstructor?(this.renderMCMFFeedback(),this.useRunestoneServices&&this.enableMCComparison()):eBookConfig.peer&&"async"===eBookConfig.peerMode&&"undefined"!=typeof studentVoteCount&&studentVoteCount>1?this.renderMCMAFeedBack():($(this.feedBackDiv).html("<p>Your Answer has been recorded</p>"),$(this.feedBackDiv).attr("class","alert alert-info")),this.didSubmit=!0}scoreMCMFSubmission(){this.answer=this.givenArray[0],this.givenArray[0]==this.correctIndexList[0]?(this.correct=!0,this.percent=1):null!=this.givenArray[0]&&(this.correct=!1,this.percent=0)}async logMCMFsubmission(t){var e=this.givenArray[0]||"",i=this.givenArray[0]==this.correctIndexList[0]?"T":"F";let s={event:"mChoice",act:"answer:"+e+":"+("T"==i?"correct":"no"),answer:e,correct:i,div_id:this.divid};eBookConfig.peer&&"undefined"!=typeof studentVoteCount&&(s.act=s.act+`:vote${studentVoteCount}`),void 0!==t&&(s.sid=t),await this.logBookEvent(s)}renderMCMFFeedback(){let t=this.givenArray[0]==this.correctIndexList[0],e=this.singlefeedback;t?($(this.feedBackDiv).html("✔️ "+e),$(this.feedBackDiv).attr("class","alert alert-info")):(null==e&&(e=""),$(this.feedBackDiv).html("✖️ "+e),$(this.feedBackDiv).attr("class","alert alert-danger"))}enableMCComparison(){eBookConfig.enableCompareMe&&(this.compareButton.disabled=!1)}instructorMchoiceModal(t){var e="<table><tr><th>Student</th><th>Answer(s)</th></tr>";for(var i in t)e+="<tr><td>"+t[i][0]+"</td><td>"+t[i][1]+"</td></tr>";return e+"</table>"}compareModal(t,e,i){var s=t.detail,r=s.answerDict,n=s.misc,o=Object.keys(r).sort(),a="<table>";a+="<tr><th>Answer</th><th>Percent</th></tr>";var h="";for(var c in o){h=o[c]===n.correct?"success":"info",a+="<tr><td>"+o[c]+"</td><td class='compare-me-progress'>";var d=r[o[c]]+"%";a+="<div class='progress'>",a+="    <div class='progress-bar progress-bar-"+h+"' style='width:"+d+";'>"+d,a+="    </div>",a+="</div></td></tr>"}a+="</table>","unavailable"!==n.yourpct&&(a+="<br /><p>You have "+n.yourpct+"% correct for all questions</p>"),void 0!==s.reslist&&(a+=this.instructorMchoiceModal(s.reslist)),$("<div class='modal fade'>    <div class='modal-dialog compare-modal'>        <div class='modal-content'>            <div class='modal-header'>                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>                <h4 class='modal-title'>Distribution of Answers</h4>            </div>            <div class='modal-body'>"+a+"            </div>        </div>    </div></div>").modal()}compareAnswers(){var t={};t.div_id=this.divid,t.course_name=eBookConfig.course,jQuery.get(`${eBookConfig.new_server_prefix}/assessment/getaggregateresults`,t,this.compareModal.bind(this))}disableInteraction(){for(var t=0;t<this.optionArray.length;t++)this.optionArray[t].input.disabled=!0}enableInteraction(){for(var t=0;t<this.optionArray.length;t++)this.optionArray[t].input.disabled=!1}}$(document).on("runestone:login-complete",(function(){$("[data-component=multiplechoice]").each((function(t){var e={orig:this,useRunestoneServices:eBookConfig.useRunestoneServices};0==$(this).closest("[data-component=timedAssessment]").length&&(window.componentMap[this.id]=new r(e))}))}));class n extends r{constructor(t){super(t),$(this.containerDiv).addClass("runestone"),this.needsReinitialization=!0,this.renderTimedIcon(this.MCContainer),this.hideButtons()}renderTimedIcon(t){var e=document.createElement("div"),i=document.createElement("img");$(i).attr({src:"../_static/clock.png",style:"width:15px;height:15px"}),e.className="timeTip",e.title="",e.appendChild(i),$(t).prepend(e)}hideButtons(){$(this.submitButton).attr("disabled","true"),$(this.submitButton).hide(),$(this.compareButton).hide()}renderMCMAFeedBack(){this.feedbackTimedMC()}renderMCMFFeedback(t,e){this.feedbackTimedMC()}feedbackTimedMC(){for(var t=0;t<this.indexArray.length;t++){var e=this.indexArray[t];$(this.feedBackEachArray[t]).html(String.fromCharCode(65+t)+". "+this.feedbackList[t]);var i=this.answerList[e].id;this.correctList.indexOf(i)>=0?this.feedBackEachArray[t].classList.add("alert","alert-success"):this.feedBackEachArray[t].classList.add("alert","alert-danger")}}renderMCFormOpts(){super.renderMCFormOpts(),this.feedBackEachArray=[];for(var t=0;t<this.answerList.length;t++){var e=this.indexArray[t],i=document.createElement("div");i.id=this.divid+"_eachFeedback_"+e,i.classList.add("eachFeedback"),this.feedBackEachArray.push(i),this.optsForm.appendChild(i)}}checkCorrectTimedMCMA(){switch(this.correctCount===this.correctList.length&&this.correctList.length===this.givenArray.length?this.correct=!0:0!==this.givenArray.length?this.correct=!1:this.correct=null,this.correct){case!0:return"T";case!1:return"F";default:return null}}checkCorrectTimedMCMF(){switch(this.correct){case!0:return"T";case!1:return"F";default:return null}}checkCorrectTimed(){return this.multipleanswers?this.checkCorrectTimedMCMA():this.checkCorrectTimedMCMF()}hideFeedback(){for(var t=0;t<this.feedBackEachArray.length;t++)$(this.feedBackEachArray[t]).hide()}reinitializeListeners(){let t=this,e=function(){t.isAnswered=!0};for(let t of this.optionArray)t.input.onclick=e}}void 0===window.component_factory&&(window.component_factory={}),window.component_factory.multiplechoice=function(t){return t.timed?new n(t):new r(t)}}}]);
//# sourceMappingURL=919.js.map